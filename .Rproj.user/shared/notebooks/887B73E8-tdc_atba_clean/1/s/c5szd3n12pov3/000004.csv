"0","# create a summary table of the top 10 most visited ports"
"0","# useful for plotting"
"0","ports_sum_top10 <- ports_long %>% "
"0","  group_by(port_label) %>% "
"0","  summarise(n_voyages = sum(n_voyages)) %>% "
"0","  top_n(10, n_voyages) %>% "
"0","  arrange(n_voyages)"
"0",""
"0","# create a horizontal barplot coloured by the number of transits that started or ended in each port"
"0","ports_long %>% "
"0","  filter(port_label %in% ports_sum_top10$port_label) %>% "
"0","  ggplot(aes(y = port_label %>% factor(levels = ports_sum_top10 %>% pull(port_label)), "
"0","             x = n_voyages, fill = cat)) + "
"0","  geom_col() +"
"0","  scale_fill_manual(values = gfw_palette('map_reception_light', type = ""discrete"")[c(4,2)],"
"0","                    name = ""Port category"","
"0","                    labels = c(""Destination"", ""Origin"")) +"
"0","  labs(x = ""No. visits"","
"0","       y = ""Port name"","
"0","       title = ""Ten most visited ports by vessels transiting\nthrough ATBA"") +"
"0","  theme_gfw_cian() +"
"0","  theme(axis.title = element_text(size = 14),"
"0","        axis.text = element_text(size = 12),"
"0","        plot.title = element_text(size = 16),"
"0","        legend.title = element_text(size = 14),"
"0","        legend.text = element_text(size = 12),"
"0","        legend.position = ""bottom"")"
