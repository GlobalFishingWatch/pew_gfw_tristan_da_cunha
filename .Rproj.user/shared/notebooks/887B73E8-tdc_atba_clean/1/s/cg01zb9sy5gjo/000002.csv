"0","# create vessel category labels for labelling map facets"
"0","vcat_labs <- c(squid_jigger = ""Squid Jigger"", drifting_longlines = ""Drifting Longlines"")"
"0",""
"0","# set bounding area"
"0","bounding_2 <- transform_box(xlim = c(-25, 5), "
"0","                            ylim = c(-50, -25),"
"0","                            output_crs = ""+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"")"
"0",""
"0","# map of gaps"
"0","gap_events_long %>%"
"0","  # create a new column gap_hours_alt that associates a gap duration with the off point"
"0","  # this allows us to map the colour fill of the point to the gap duration "
"0","  mutate(gap_hours_alt = if_else(gap_event == ""off"", gap_hours, as.numeric(NA))) %>%"
"0","  filter(vessel_class != ""set_longlines"") %>% "
"0","  ggplot() +"
"0","  geom_path(aes(x = lon, y = lat, colour = gap_hours, group = gap_id), size = 1, alpha = 0.4) +"
"0","  geom_point(aes(x = lon, y = lat, colour = gap_hours, fill = gap_hours_alt), size = 2, shape = 21, alpha = 0.6) +"
"0","  geom_gfw_eez(lwd = 1) + "
"0","  geom_sf(data = atba_sf, colour = gfw_palette(""primary"")[1], linetype = 1, fill = NA) +"
"0","  geom_sf(data = tdc_sf, fill = gfw_palette(""map_country_dark"")[1]) +"
"0","  facet_grid(~ vessel_class,"
"0","             labeller = labeller(vessel_class = vcat_labs)) +"
"0","  labs(title = ""AIS gap events near Tristan da Cunha"","
"0","       subtitle = ""Jan. 1, 2019 to June 30, 2021"") +"
"0","  scale_colour_viridis_c(name = ""AIS gap (hours)"","
"0","                         begin = 0.2,"
"0","                         end = 1.0,"
"0","                         option = ""viridis"","
"0","                         limits = c(12, 168),"
"0","                         oob = scales::squish,"
"0","                         breaks = c(12, 24, 48, 72, 168),"
"0","                         labels = c(""12"", ""24"", ""48"", ""72"", "">168 (1 week)"")) +"
"0","  scale_fill_viridis_c(name = ""AIS gap (hours)"","
"0","                         begin = 0.2,"
"0","                         end = 1.0,"
"0","                         option = ""viridis"","
"0","                         limits = c(12, 168),"
"0","                         oob = scales::squish,"
"0","                         breaks = c(12, 24, 48, 72, 168),"
"0","                         labels = c(""12"", ""24"", ""48"", ""72"", "">168 (1 week)""),"
"0","                       na.value = NA) +"
"0","  scale_alpha_manual(values = c(0, 1)) +"
"0","  scale_x_continuous(breaks = c(-25, -15, -5, 5)) +"
"0","  guides(fill = ""none"", alpha = ""none"") +"
"0","  theme_gfw_map_cian() +"
"0","  theme(plot.title = element_text(size = 20),"
"0","        plot.subtitle = element_text(size = 16),"
"0","        axis.text = element_text(size = 16),"
"0","        legend.title = element_text(size = 20),"
"0","        legend.text = element_text(size = 16),"
"0","        strip.text = element_text(size = 16)) +"
"0","  coord_sf(xlim = c(bounding_2$box_out[['xmin']], bounding_2$box_out[['xmax']]), "
"0","           ylim = c(bounding_2$box_out[['ymin']], bounding_2$box_out[['ymax']]), "
"0","           crs = bounding_2$out_crs)"
