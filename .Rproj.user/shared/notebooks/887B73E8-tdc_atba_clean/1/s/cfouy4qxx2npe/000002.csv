"0","# set the bounding are for the map"
"0","bounding_ports <- transform_box(xlim = c(min(ports_long$lon) - 1, "
"0","                                         max(ports_long$lon) + 1), "
"0","                                ylim = c(min(ports_long$lat) - 1, "
"0","                                         max(ports_long$lat) + 1),"
"0","                                output_crs = ""+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"")"
"0",""
"0","# create the map using ggplot2"
"0","ports_long %>% "
"0","  # here we wanted to summarise the number of pots starting OR ending in each port"
"0","  # so we used group_by(port_label), excluding the origin/destination category"
"0","  group_by(port_label) %>% "
"0","  summarise(n_voyages = sum(n_voyages), .groups = ""keep"","
"0","            lon = mean(lon),"
"0","            lat = mean(lat)) %>% "
"0","    ggplot() +"
"0","  fishwatchr::geom_gfw_eez(theme = 'dark') +"
"0","  fishwatchr::geom_gfw_land(theme = 'dark') +"
"0","  geom_point(aes(x = lon, y = lat, size = n_voyages), alpha = 0.5, colour = gfw_palette(""map_reception_light"")[4]) +"
"0","  scale_size_continuous(name = ""No. visits"") +"
"0","  geom_sf(data = atba_sf, colour = gfw_palette(""diverging"")[1], linetype = 1, fill = NA) +"
"0","  geom_sf(data = tdc_sf, fill = gfw_palette(""map_country_dark"")[1]) +"
"0","  labs(title = ""Ports visited by vessels transiting through ATBA"","
"0","       subtitle = ""April 1, 2020 to June 30, 2021"") +"
"0","  theme_gfw_map_cian(theme = 'dark') +"
"0","  theme(legend.position = ""bottom"","
"0","        plot.title = element_text(size = 20),"
"0","        plot.subtitle = element_text(size = 16),"
"0","        axis.text = element_text(size = 12),"
"0","        legend.title = element_text(size = 14),"
"0","        legend.text = element_text(size = 12)) +"
"0","  coord_sf(xlim = c(bounding_ports$box_out[['xmin']], bounding_ports$box_out[['xmax']]), "
"0","           ylim = c(bounding_ports$box_out[['ymin']], bounding_ports$box_out[['ymax']]), "
"0","           crs = bounding_ports$out_crs)"
